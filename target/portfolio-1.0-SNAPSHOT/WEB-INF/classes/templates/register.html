<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회원가입</title>
    <link rel="stylesheet" th:href="@{/css/register.css}">
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="/js/register.js?ver=20260107"></script>
    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
</head>

<body>
<div id="toast"><span id="toast-message"></span></div>

<div class="signup-container">
    <h2>회원가입</h2>

    <!-- 오류 메시지 -->
    <div class="error-message" th:if="${errorMessage != null}" th:text="${errorMessage}" style="color:red; margin-bottom:10px;"></div>

    <form th:action="@{/register}" method="post" id="registerForm">
        <div class="input-group">
            <label for="email">이메일</label>
            <div style="display: flex; gap: 5px; align-items: center;">
                <input type="text" id="email_id" name="email_id" placeholder="이메일 아이디" required
                       th:value="${emailId != null} ? ${emailId} : ''" style="flex: 1.5; min-width: 0;">
                <span>@</span>
                <input type="text" id="email_domain" name="email_domain" placeholder="도메인 입력" required
                       th:value="${emailDomain != null} ? ${emailDomain} : ''" style="flex: 1.5; min-width: 0;">
                <select id="domain_select" style="flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 5px; background-color: #fff;">
                    <option value="">직접 입력</option>
                    <option value="naver.com">naver.com</option>
                    <option value="gmail.com">gmail.com</option>
                    <option value="daum.net">daum.net</option>
                    <option value="hanmail.net">hanmail.net</option>
                    <option value="kakao.com">kakao.com</option>
                </select>
                <button type="button" id="check-email-btn" style="padding:10px 14px; background-color:#3498db; color:white; border:none; border-radius:5px; cursor:pointer;">
                    중복 확인
                </button>
            </div>

            <span id="email-check-msg" style="font-size:12px; color:#e74c3c; display:block; margin-top:5px;"></span>
            <input type="hidden" id="email" name="email" th:value="${email != null} ? ${email} : ''">
        </div>

        <div class="input-group">
            <label for="password">비밀번호</label>
            <input type="password" id="password" name="password" placeholder="대/소문자, 숫자, 특수문자 포함 8자 이상" required
                   th:value="${password != null} ? ${password} : ''">
            <span id="strength-message" style="font-size: 12px; margin-top: 5px;"></span>
        </div>

        <div class="input-group">
            <label for="confirm-password">비밀번호 확인</label>
            <input type="password" id="confirm-password" name="confirm-password" required>
            <span id="password-message" style="font-size: 12px; margin-top: 5px;"></span>
        </div>

        <div class="input-group">
            <label for="name">이름</label>
            <input type="text" id="name" name="name" placeholder="실명을 입력하세요" required
                   th:value="${name != null} ? ${name} : ''">
        </div>

        <div class="input-group">
            <label for="nickname">닉네임</label>
            <input type="text" id="nickname" name="nickname" placeholder="사용할 닉네임" required
                   th:value="${nickname != null} ? ${nickname} : ''">
        </div>

        <div class="input-group">
            <label for="hp">휴대폰 번호</label>
            <input type="tel" id="hp" name="hp" placeholder="010-0000-0000" maxlength="13" required
                   th:value="${hp != null} ? ${hp} : ''">
        </div>

        <div class="input-group">
            <label for="address">주소</label>
            <div style="display: flex; gap: 8px; align-items: center;">
                <input type="text" id="address1" name="address1" placeholder="주소 검색을 이용하세요" required
                       style="flex: 1; min-width: 0; padding: 12px; border: 1px solid #ddd; border-radius: 5px;"
                       th:value="${address1 != null} ? ${address1} : ''">
                <button type="button" id="address-btn"
                        style="width: 100px; padding: 10px 0; font-size: 14px; background-color: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer; white-space: nowrap;">
                    주소 검색
                </button>
            </div>

            <div id="address-layer" style="display:none; border:1px solid #ddd; width:100%; height:400px; margin-top:10px; position:relative">
                <img src="//t1.daumcdn.net/postcode/resource/images/close.png" id="btnFoldWrap" 
                     style="cursor:pointer;position:absolute;right:0px;top:-1px;z-index:1" alt="접기 버튼">
            </div>

            <input type="text" id="address2" name="address2" placeholder="상세 주소를 입력하세요" required
                   th:value="${address2 != null} ? ${address2} : ''">
            <input type="hidden" id="address" name="address" th:value="${address != null} ? ${address} : ''">
        </div>

        <div class="checkbox-group">
            <input type="checkbox" id="terms" name="terms" required>
            <label for="terms">이용약관 및 개인정보 처리방침에 동의합니다.</label>
        </div>

        <button type="submit" class="submit-btn">회원가입</button>

        <div class="links">
            이미 계정이 있으신가요? <a th:href="@{/users/login}">로그인</a>
        </div>
    </form>
</div>
</body>
</html>
